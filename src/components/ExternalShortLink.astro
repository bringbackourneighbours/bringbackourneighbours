---
import { getEntry } from 'astro:content';
import Link from '../design/Link.astro';
import { DEFAULT_LANG, type LanguagesValue } from '../util/languages.enum';

interface Props {
  identifier: string;
  lang?: LanguagesValue;
}

const { identifier, lang = DEFAULT_LANG } = Astro.props;

// FIXME: this seems needless... but without the type is not working. no idea why
const getLink = async (identifier: string) =>
  await getEntry('links', identifier);

const link = await getLink(identifier);

let localizedLinkData = {
  ...link?.data['all'],
  ...link?.data[lang],
};
---

{
  localizedLinkData?.url ? (
    <Link
      href={localizedLinkData.url}
      lang={lang}
    >
      {localizedLinkData.type}: {localizedLinkData.title}
    </Link>
  ) : (
    <em>LINK NOT FOUND</em>
  )
}
